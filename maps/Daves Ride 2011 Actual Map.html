<!DOCTYPE html>
<html>
<head>
    
    <meta charset="utf-8" >
	<title>Dave's Ride 2011 - Ridden</title>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" >
    <link rel="stylesheet" href="leaflet-panel-layers-1.2.4/src/leaflet-panel-layers.css" />
    <link rel="stylesheet" href="Leaflet.defaultextent-0.0.2/dist/leaflet.defaultextent.css" />
    <link rel="stylesheet" href="TitleText_Actual.css"/>
	
	<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" ></script>
	<script src="leaflet-panel-layers-1.2.4/src/leaflet-panel-layers.js"></script>

    <!-- <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.2.0/leaflet-omnivore.min.js"></script> -->

    <script src="leaflet-gpx-1.3.1/gpx.js"></script>
    <script src="leaflet.fullscreen-1.1.4/Control.FullScreen.js"></script>
    <script src="Leaflet.defaultextent-0.0.2/dist/leaflet.defaultextent.js"></script>

	<style type="text/css">
	html, body, #mapid {
		width: 100vw;
		height: 100vh;
        margin: 0;
        }

    /* FullScreen */
		.leaflet-control-zoom-fullscreen { background-image: url(icon-fullscreen.png); }
		/* on selector per rule as explained here : http://www.sitepoint.com/html5-full-screen-api/ */
		#mapid:-webkit-full-screen { width: 100% !important; height: 100% !important; z-index: 99999; }
		#mapid:-moz-full-screen { width: 100% !important; height: 100% !important; z-index: 99999; }
		#mapid:full-screen { width: 100% !important; height: 100% !important; z-index: 99999; }
		.leaflet-pseudo-fullscreen { position: fixed !important; width: 100% !important; height: 100% !important; top: 0px !important; left: 0px !important; z-index: 99999; }
	</style>

</head>

<body>

<div id="mapid">
    <h1></h1>
</div>

<script language="JavaScript" type="text/javascript">

        /* set up array holding details of the 28 GPX tracks */
	var gpx_s = [
		['GPX Files/25_09_2011 9_51_05 AM_history.gpx', '#e60000', 'Day 1 - 25th Sep 2011'], 
		['GPX Files/26_09_2011 7_21_23 AM_history.gpx', '#e67500', 'Day 2 - 26th Sep 2011'],
		['GPX Files/27_09_2011 8_50_24 AM_history.gpx', '#ffff00', 'Day 2 Part 2 - 27th Sep 2011'],
		['GPX Files/28_09_2011 7_32_59 AM_history.gpx', '#71e600', 'Day 4 - 28th Sep 2011'],
		['GPX Files/29_09_2011 7_27_04 AM_history.gpx', '#33cc00', 'Day 5 - 29th Sep 2011'],
		['GPX Files/30_09_2011 8_03_38 AM_history.gpx', '#00ffcc', 'Day 6 - 30th Sep 2011'],
		['GPX Files/2_10_2011 7_00_11 AM_history.gpx', '#00ccff', 'Day 8 - 2nd Oct 2011'],
		['GPX Files/3_10_2011 7_56_24 AM_history.gpx', '#0071e6', 'Day 9 - 3rd Oct 2011'],
		['GPX Files/4_10_2011 8_10_23 AM_history.gpx', '#0000e6', 'Day 10 - 4th Oct 2011'],
		['GPX Files/7_10_2011 7_05_40 AM_history.gpx', '#7500e6', 'Day 13 - 7th Oct 2011'],
		['GPX Files/8_10_2011 7_02_27 AM_history.gpx', '#e60000', 'Day 14 - 8th Oct 2011'], 
		['GPX Files/9_10_2011 6_33_30 AM_history.gpx', '#e67500', 'Day 15 - 9th Oct 2011'],
		['GPX Files/10_10_2011 6_34_45 AM_history.gpx', '#ffff00', 'Day 16 - 10th Oct 2011'],
		['GPX Files/11_10_2011 5_59_23 AM_history.gpx', '#71e600', 'Day 17 - 11th Oct 2011'],
		['GPX Files/12_10_2011 5_43_40 AM_history.gpx', '#33cc00', 'Day 18 - 12th Oct 2011'],
		['GPX Files/13_10_2011 5_19_15 AM_history.gpx', '#00ffcc', 'Day 19 - 13th Oct 2011'],
		['GPX Files/14_10_2011 7_41_41 AM_history.gpx', '#00ccff', 'Day 20 - 14th Oct 2011'],
		['GPX Files/15_10_2011 7_28_54 AM_history.gpx', '#0071e6', 'Day 21 - 15th Oct 2011'],
		['GPX Files/17_10_2011 7_04_40 AM_history.gpx', '#0000e6', 'Day 23 - 17th Oct 2011'],
		['GPX Files/18_10_2011 7_59_53 AM_history.gpx', '#7500e6', 'Day 24 - 18th Oct 2011'],
		['GPX Files/19_10_2011 6_43_02 AM_history.gpx', '#e60000', 'Day 25 - 19th Oct 2011'],
		['GPX Files/20_10_2011 6_53_33 AM_history.gpx', '#e67500', 'Day 26 - 20th Oct 2011'],
		['GPX Files/23_10_2011 6_34_21 AM_history.gpx', '#ffff00', 'Day 29 - 23rd Oct 2011'],
		['GPX Files/24_10_2011 6_48_48 AM_history.gpx', '#71e600', 'Day 30 - 24th Oct 2011'],
		['GPX Files/25_10_2011 6_48_41 AM_history.gpx', '#33cc00', 'Day 31 - 25th Oct 2011'],
		['GPX Files/27_10_2011 7_12_39 AM_history.gpx', '#00ffcc', 'Day 33 - 27th Oct 2011'],
		['GPX Files/28_10_2011 7_18_30 AM_history.gpx', '#00ccff', 'Day 34 - 28th Oct 2011'],
		['GPX Files/29_10_2011 7_07_24 AM_history.gpx', '#0071e6', 'Day 35 - 29th Oct 2011'],
		['GPX Files/30_10_2011 8_02_29 AM_history.gpx', '#0000e6', 'Day 36 - 30th Oct 2011']
		];

    /* 	Set up global variables */
    var lat_nE_1
	var lng_nE_1
	var lat_sW_1
	var lng_sW_1
	var bnds_1
    var bnds_2
	var gpx = [];
    var Att_Com = ' | Side Panel &copy; <a href="https://github.com/stefanocudini/leaflet-panel-layers/blob/master/license.txt">2015-2017 Stefano Cudini</a> | '+
        '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a> | ' +
        'Full Screen &copy; <a href="https://github.com/brunob/leaflet.fullscreen/blob/master/LICENSE">2013, Bruno Bergot</a>'
            
    /* Set up initial map layer */
    
    // Fullscreen & restore default zoom
    var mymap = L.map('mapid', {
        defaultExtentControl: true, 
        fullscreenControl: true,
        fullscreenControlOptions: { // optional
            title:"Toggle Fullscreen"}
    });

    // var mymap = L.map('mapid').setView([-37.763658, 145.077896], 12),
	mboxLayer = new 
		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZGF2ZWpkNDMxNzgiLCJhIjoiY2puZ3ByeTlhMDFicDNrcG1yMjlkcmxjciJ9.4_vjg7yVBgk-CZtkol42Ig', { 
		maxZoom: 23,
        attribution:
        'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors | ' +
		'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>' + 
        Att_Com,
		id: 'mapbox.streets'
        });
        mymap.addLayer(mboxLayer); 

    // detect fullscreen toggling
    mymap.on('enterFullscreen', function(){
        if(window.console) window.console.log('enterFullscreen');
        });
    mymap.on('exitFullscreen', function(){
        if(window.console) window.console.log('exitFullscreen');
        });
	
/*  Track layers 1 to 27, imported from GPX files */
    for (i = 1; i < 28 ; i++) {    //29
        Load_GPXs(gpx_s[i][0] ,gpx_s[i][1]);   
        }
        function Load_GPXs(myfile, mycolor) {
        gpx[i] = new L.GPX(myfile, {
        async: true,
        polyline_options: {
        color: mycolor,
        opacity: .8,
        weight: 4,
        lineCap: 'round'
        }     
        })
        .bindPopup(gpx_s[i][2])
        .bindTooltip(gpx_s[i][2])
        .on('loaded', function(e) {
        bnds_1 = (e.target.getBounds())
        if (bnds_1._northEast.lat > lat_nE_1){lat_nE_1 = bnds_1._northEast.lat}
        if (bnds_1._northEast.lng > lng_nE_1){lng_nE_1 = bnds_1._northEast.lng}
        if (bnds_1._southWest.lat < lat_sW_1){lat_sW_1 = bnds_1._southWest.lat}
        if (bnds_1._southWest.lng < lng_sW_1){lng_sW_1 = bnds_1._southWest.lng}
        });
        mymap.addLayer(gpx[i]);
        }   
     
    /* Track layer 0, imported from GPX file. Sets lat_nE_1, lng_nE_1, lat_sW_1, lng_sW_1 to initial values */
    var gpx_0 = new L.GPX(gpx_s[0][0], {
    	async: true,
        polyline_options: {
        color: gpx_s[0][1],
        opacity: .8,
        weight: 4,
        lineCap: 'round'
        }    
        })
        .bindPopup(gpx_s[0][2])
        .bindTooltip(gpx_s[0][2])
        .on('loaded', function(e) {
        bnds_1 = (e.target.getBounds())
        lat_nE_1 = bnds_1._northEast.lat
        lng_nE_1 = bnds_1._northEast.lng
        lat_sW_1 = bnds_1._southWest.lat
        lng_sW_1 = bnds_1._southWest.lng
        ;
        });
    mymap.addLayer(gpx_0);

    /* Track layer 28, imported from GPX file. Fits map to bounds of all tracks */
    var gpx_28 = new L.GPX(gpx_s[28][0], {
        async: true,
        polyline_options: {
        color: gpx_s[28][1],
        opacity: .8,
        weight: 4,
        lineCap: 'round'
        }
        })
        .bindPopup(gpx_s[28][2])
        .bindTooltip(gpx_s[28][2])
        .on('loaded', function(e) {
        
        bnds_1 = (e.target.getBounds())
        if (bnds_1._northEast.lat > lat_nE_1){lat_nE_1 = bnds_1._northEast.lat}
        if (bnds_1._northEast.lng > lng_nE_1){lng_nE_1 = bnds_1._northEast.lng}
        if (bnds_1._southWest.lat < lat_sW_1){lat_sW_1 = bnds_1._southWest.lat}
        if (bnds_1._southWest.lng < lng_sW_1){lng_sW_1 = bnds_1._southWest.lng}
        bnds_1._northEast.lat = lat_nE_1
        bnds_1._northEast.lng = lng_nE_1
        bnds_1._southWest.lat = lat_sW_1
        bnds_1._southWest.lng = lng_sW_1
        mymap.fitBounds(bnds_1)
        ;
        });
    mymap.addLayer(gpx_28);

    /* Set up click on track & zoom map to Track */
    gpx_0.on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[1].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }


    gpx[2].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[3].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[4].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[5].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[6].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[7].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[8].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[9].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[10].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[11].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[12].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[13].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[14].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[15].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[16].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[17].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[18].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[19].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[20].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[21].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[22].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[23].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[24].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[25].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[26].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx[27].on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

    gpx_28.on('click', onTrackclick);
    function onTrackclick(e){
        bnds_2 = e.target
        mymap.fitBounds(bnds_2.getBounds());
    }

                                                        
    /* Sets map layers fro side panel */
    var baseLayers = [
        {		
            group: "Maps",
            collapsed: true,
            layers: [
                {
                    name: "MapBox Streets",
                    layer: mboxLayer
                },
                {
                    name: "Mapbox Outdoors",
                    layer: L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZGF2ZWpkNDMxNzgiLCJhIjoiY2puZ3ByeTlhMDFicDNrcG1yMjlkcmxjciJ9.4_vjg7yVBgk-CZtkol42Ig', { 
                    maxZoom: 23,
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors | ' +
                    'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>' +
                    Att_Com,
                    id: 'mapbox.outdoors' })
                },
                {
                    name: "Mapbox Light",
                    layer: L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZGF2ZWpkNDMxNzgiLCJhIjoiY2puZ3ByeTlhMDFicDNrcG1yMjlkcmxjciJ9.4_vjg7yVBgk-CZtkol42Ig', { 
                    maxZoom: 23,
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors | ' +
                    'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>' +
                    Att_Com,
                    id: 'mapbox.light' })
                },
                {
                    name: "Open Street Map",
                    layer: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { 
                    maxZoom: 23,
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors' +
                    Att_Com,
                    })
                },
                {
                    name: "Open Cycle Map",
                    layer: L.tileLayer('https://tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=06003a6a184c48be994d17d414a7746e', { 
                    maxZoom: 23,
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors' +
                    Att_Com,
                    })
                }
            ]
        }
    ];
	
    /* Sets Track layers in side panel */
    var overLayers = [
        {
            group: "Tracks ridden each day",
            //collapsed: true,
            layers: [
        
                {
                    name: gpx_s[0][2],
                    layer: gpx_0                    
                },
                {
                    name: gpx_s[1][2],
                    layer: gpx[1]
                },
                {
                    name: gpx_s[2][2],
                    layer: gpx[2]
                },
                {
                    name: gpx_s[3][2],
                    layer: gpx[3]
                },
                {
                    name: gpx_s[4][2],
                    layer: gpx[4]
                },				
                {
                    name: gpx_s[5][2],
                    layer: gpx[5]
                },				
                {
                    name: gpx_s[6][2],
                    layer: gpx[6]
                },				
                {
                    name: gpx_s[7][2],
                    layer: gpx[7]
                },				
                {
                    name: gpx_s[8][2],
                    layer: gpx[8]
                },				
                {
                    name: gpx_s[9][2],
                    layer: gpx[9]
                },				
                {
                    name: gpx_s[10][2],
                    layer: gpx[10]
                },				
                {
                    name: gpx_s[11][2],
                    layer: gpx[11]
                },				
                {
                    name: gpx_s[12][2],
                    layer: gpx[12]
                },				
                {
                    name: gpx_s[13][2],
                    layer: gpx[13]
                },				
                {
                    name: gpx_s[14][2],
                    layer: gpx[14]
                },				
                {
                    name: gpx_s[15][2],
                    layer: gpx[15]
                },				
                {
                    name: gpx_s[16][2],
                    layer: gpx[16]
                },				
                {
                    name: gpx_s[17][2],
                    layer: gpx[17]
                },				
                {
                    name: gpx_s[18][2],
                    layer: gpx[18]
                },				
                {
                    name: gpx_s[19][2],
                    layer: gpx[19]
                },				
                {
                    name: gpx_s[20][2],
                    layer: gpx[20]
                },				
                {
                    name: gpx_s[21][2],
                    layer: gpx[21]
                },				
                {
                    name: gpx_s[22][2],
                    layer: gpx[22]
                },				
                {
                    name: gpx_s[23][2],
                    layer: gpx[23]
                },
                {
                    name: gpx_s[24][2],
                    layer: gpx[24]
                },
                {
                    name: gpx_s[25][2],
                    layer: gpx[25]
                },
                {
                    name: gpx_s[26][2],
                    layer: gpx[26]
                },
                {
                    name: gpx_s[27][2],
                    layer: gpx[27]
                },                {
                    name: gpx_s[28][2],
                    layer: gpx_28
                }
            ]
        }
    ];

    /* Sets control for side panel */
    var panelLayers = new L.Control.PanelLayers(baseLayers, overLayers, {
            //compact: true,
            //collapsed: true,
            collapsibleGroups: true,
            //title: "Map Options"
        });

    /* Adds side panel to map */
    mymap.addControl(panelLayers);

    var myIcon = L.icon({
        iconUrl: 'Bicycle-Red.png',
        iconSize: [50, ],
        iconAnchor: [10, 30],
        popupAnchor: [6, -25],
	});

	var myPopup = L.popup()
        .setContent ('<b>The Finish !</b><br>Day 36, Final Day - 30th October 2011<br>Finished riding 1:15pm at Birrarung Marr')
    ;
    L.marker([-37.818751, 144.97285], {
		icon: myIcon
	}).addTo(mymap).bindPopup(myPopup).openPopup();    

</script>

</body>
</html>